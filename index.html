<!DOCTYPE html>
<html>
<head>
  <title>"Boom&What MAP"</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map {
      position: absolute;
      height: 100%;
      width: 100%;
      background-color: #0fa8d2; 
    }
    #mapSelector {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 1000;
      padding: 5px;
    }
  </style>
</head>
<body>

<select id="mapSelector">
  <option value="map1">Atlas</option>
  <option value="map2">satellite</option>
</select>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>

  const imageWidth = 8192;
  const imageHeight = 8192;
  const imageBounds = [[0, 0], [imageHeight, imageWidth]];

  const map = L.map('map', {
    crs: L.CRS.Simple,
    minZoom: -4,
    maxZoom: 2
  });

  const maps = {
    map1: {
      layer: L.imageOverlay('map1.png', imageBounds),
      bgColor: "#0fa8d2"
    },
    map2: {
      layer: L.imageOverlay('map2.png', imageBounds),
      bgColor: "#143d6b" 
    }
  };

  let currentMap = maps.map1.layer.addTo(map);
  map.fitBounds(imageBounds);

  document.getElementById('mapSelector').addEventListener('change', (e) => {
    map.removeLayer(currentMap);

    const selected = maps[e.target.value];
    currentMap = selected.layer.addTo(map);

    document.getElementById('map').style.backgroundColor = selected.bgColor;
  });

  const offsetX = 6487;
  const offsetY = 9474;

  function gtaToLeaflet(gameX, gameY) {
    const leafletX = gameX + offsetX;
    const leafletY = -gameY + offsetY;
    return [leafletY, leafletX];
  }

  function leafletToGTA(leafletX, leafletY) {
    const gameX = leafletX - offsetX;
    const gameY = -(leafletY - offsetY);
    return [gameX, gameY];
  }

  function customIcon(iconName) {
    return L.icon({
      iconUrl: iconName + '.png',
      iconSize: [20, 20],
      iconAnchor: [16, 32],
      popupAnchor: [-10, -27]
    });
  }

  const gtaLocations = [
    { name: "โรงพยาบาลกลาง", x: -2504, y: 7728, icon: "01" },
    { name: "สเตเดียม", x: -2944 , y: 8107, icon: "01" },
    { name: "แยกบ้านแรงค์", x: -2905 , y: 7756, icon: "01" },
    { name: "เส้นปั๊มขวด", x: -4272 , y: 5336, icon: "01" },
  ];

  gtaLocations.forEach(loc => {
    const [y, x] = gtaToLeaflet(loc.x, loc.y);
    L.marker([y, x], { icon: customIcon(loc.icon) })
      .addTo(map)
      .bindPopup(`${loc.name}<br>GTA (${loc.x}, ${loc.y})`);
  });

  map.on('click', function (e) {
    const lx = e.latlng.lng;
    const ly = e.latlng.lat;
    const [gx, gy] = leafletToGTA(lx, ly);
    L.popup()
      .setLatLng(e.latlng)
      .setContent(`Leaflet: (${lx.toFixed(0)}, ${ly.toFixed(0)})<br>GTA: (${gx.toFixed(0)}, ${gy.toFixed(0)})`)
      .openOn(map);
    console.log(`CLICK: Leaflet(${lx}, ${ly}) -> GTA(${gx}, ${gy})`);
  });

</script>

</body>
</html>

